% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_cramersV_simulation.R
\name{run_cramersV_simulation}
\alias{run_cramersV_simulation}
\title{Run Parallel Simulations of Cramér's V for Power Estimation}
\usage{
run_cramersV_simulation(
  simulations,
  iterations,
  n,
  p,
  lambda,
  b,
  cdf_vals,
  lowerCor = 0.1,
  upperCor = 0.9,
  chiSquareU
)
}
\arguments{
\item{simulations}{Number of independent simulation sets to run.}

\item{iterations}{Number of repetitions per simulation (total runs = \code{simulations × iterations}).}

\item{n}{Sample size for each simulation.}

\item{p}{Number of variables (features).}

\item{lambda}{Parameter of the truncated geometric distribution.}

\item{b}{Number of bins (categories) for discretizing the distribution.}

\item{cdf_vals}{A numeric vector giving the cumulative distribution function of the truncated geometric distribution
(typically from \code{\link{compute_trunc_geom_cdf}}).}

\item{lowerCor}{Minimum correlation coefficient used to generate positive-definite correlation matrices (default: 0.1).}

\item{upperCor}{Maximum correlation coefficient used to generate positive-definite correlation matrices (default: 0.9).}

\item{chiSquareU}{The upper threshold for the chi-square statistic under the null hypothesis (used to compute critical Cramér's V).}
}
\value{
An integer count indicating the number of simulation runs (out of total) where at least one variable's Cramér's V exceeds its critical value.
}
\description{
This function runs multiple simulations to estimate the probability of detecting a significant deviation from uniformity
in ordinal data using Cramér's V. Each simulation draws samples from a truncated geometric distribution with optional correlation
between variables, then evaluates whether any variable exceeds the critical value of Cramér's V.
}
\details{
For multivariate data (\code{p > 1}), the function generates positively correlated latent variables using Cholesky decomposition.
These are transformed to uniform \link{0,1} variables using the normal CDF, then mapped to ordinal categories using a truncated geometric CDF.
Cramér's V is computed for each variable, and if any exceed the critical threshold, the run is counted as a "positive."
The function uses parallel computation to speed up execution.
}
\examples{
cdf <- compute_trunc_geom_cdf(lambda = 0.3, b = 5)
run_cramersV_simulation(
  simulations = 2, iterations = 5, n = 100, p = 3, lambda = 0.3, b = 5,
  cdf_vals = cdf, lowerCor = 0.2, upperCor = 0.8, chiSquareU = qchisq(0.95, df = 4)
)

}
